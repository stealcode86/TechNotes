1) Multiple Select in one CTE https://stackoverflow.com/questions/9682488/multiple-select-against-one-cte
2) Return value if no record is found https://stackoverflow.com/questions/8098795/return-a-value-if-no-record-is-found
